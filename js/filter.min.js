jQuery(document).ready(function () {
  function e(e, t) {
    $(".loading").css("display", "flex"),
      $(".load_more_btn").find(".moreInfo ").text("Loading..."),
      $.ajax({
        type: "POST",
        url: "/filter_update",
        data: e,
        success: function (e) {
          const a = /(casino-card)/g,
            n = e.match(a);
          if (
            (console.log(n),
            (0 != n && null != n) ||
              ($(".loading").hide(), $(".load_more_btn").hide()),
            "replace" == t &&
              ($(".loading").css("top", "0"),
              $(".load_more_btn").show(),
              $(".load_more_btn").attr("data-page", "1"),
              $("#replace").html(""),
              $("#replace").append(e),
              n || $(".load_more_btn").hide(),
              n.length < 12 && $(".load_more_btn").hide()),
            "add" == t)
          ) {
            $(".loading").css("bottom", "0");
            var o = $(".load_more_btn").attr("data-page");
            (o = Number(o)),
              o++,
              n.length < 12 && $(".load_more_btn").hide(),
              $(".load_more_btn").attr("data-page", o),
              $("#replace").append(e);
          }
          $(".loading").hide(),
            $(".load_more_btn").find(".moreInfo ").text("Load More");
        },
        error: function (e) {
          console.log("An error occurred."), console.log(e);
        },
      });
  }
  function t(t, a) {
    n = "replace";
    const i = [
      "usstates",
      "countries",
      "deposit_methods",
      "currencies",
      "games",
      "popular",
    ];
    i.includes(a) && (o[a].push(t), e(o, n));
  }
  function a(t, a) {
    if (((n = "replace"), o.hasOwnProperty(a))) {
      var i = o[a].indexOf(t);
      i > -1 && o[a].splice(i, 1), e(o, n);
    }
  }
  var n,
    o = {
      page: 0,
      countries: [],
      usstates: [],
      games: [],
      deposit_methods: [],
      currencies: [],
      popular: [],
      lang: "en",
    };
  $(".current_selections")
    .find("input")
    .each(function () {
      var e = $(this).attr("data-ind");
      console.log("ind + " + e);
      var t = $(this).attr("id");
      [
        "usstates",
        "countries",
        "deposit_methods",
        "currencies",
        "games",
      ].includes(e) && o[e].push(t),
        console.log(o);
    });
  var i = 1;
  $("#addFilterSection").on("click", "input[type=checkbox]", function () {
    console.log("clicked #get_filter");
    var e,
      n = $(this),
      c = $(this).attr("data-ind"),
      s = $(this).attr("data-name"),
      r = $(this).attr("data-id");
    (o.page = 0),
      console.log(o),
      1 == n.prop("checked")
        ? ($(this).prop("checked", !0),
          (e = `<label class="inputbox">\n                      <span class="name">${s}</span>\n                      <input class="selectedInputs"  type="checkbox" data-id="${r}" data-name="${s}" value="${r}" data-ind="${c}" checked="checked">\n                      <span class="checkmark"></span>\n                  </label>`),
          $(".selected").find(".current_selections").append(e),
          t(r, c),
          i++,
          console.log(i),
          $("#filterCounter").html(i))
        : (console.log("this is what happens the second click"),
          a(r, c),
          i--,
          $("#filterCounter").html(i),
          $(".selected").mouseup(function () {
            $(this).find(`[data-id="${r}"]`).parent().remove();
          }));
  }),
    $("#selectedFilters").on("click", "input[type=checkbox]", function () {
      var e = $(this).attr("data-ind"),
        t = $(this).attr("data-id");
      $(this).prop("checked", !1);
      var n = $(this);
      $("#get_filter").find(`#${t}`).prop("checked", !1),
        setTimeout(function () {
          n.parent().remove();
        }, 10),
        a(t, e),
        i--,
        $("#filterCounter").html(i);
    }),
    $(".load_more_btn").on("click", function () {
      console.log("clicked");
      var t = $(this).attr("data-page"),
        a = $(this).attr("data-lang");
      (o.page = t), (o.lang = a), (n = "add"), e(o, n);
    }),
    $(document).on("keyup", ".my-textbox", function () {
      var e = $(this).val(),
        t = new RegExp("^" + e, "i");
      $(this)
        .parent()
        .parent()
        .find(".filter")
        .each(function () {
          if ("/^/i" == t)
            $(this).parent().parent().find(".popSelection").show(),
              $(this).hide();
          else {
            var e = t.test($(".name", this).text());
            $(this).toggle(e),
              $(this).parent().parent().find(".popSelection").hide();
          }
        });
    });
});
